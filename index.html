<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeadForge AI - Enterprise Lead Generation & SEO Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0EA5E9;
            --gold: #F59E0B;
            --charcoal: #1F2937;
            --dark: #0F172A;
        }
        
        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
            color: #F8FAFC;
        }
        
        .display-font {
            font-family: 'Bebas Neue', cursive;
            letter-spacing: 0.05em;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #0EA5E9 0%, #F59E0B 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .card-glow {
            box-shadow: 0 0 40px rgba(14, 165, 233, 0.15);
            border: 1px solid rgba(14, 165, 233, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0EA5E9 0%, #0284C7 100%);
            box-shadow: 0 4px 20px rgba(14, 165, 233, 0.4);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            box-shadow: 0 6px 30px rgba(14, 165, 233, 0.6);
            transform: translateY(-2px);
        }
        
        .btn-gold {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
        }
        
        .btn-gold:hover {
            box-shadow: 0 6px 30px rgba(245, 158, 11, 0.6);
            transform: translateY(-2px);
        }
        
        .input-glow:focus {
            outline: none;
            border-color: #0EA5E9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-slide-up {
            animation: slideUp 0.6s ease-out forwards;
        }
        
        .stagger-1 { animation-delay: 0.1s; opacity: 0; }
        .stagger-2 { animation-delay: 0.2s; opacity: 0; }
        .stagger-3 { animation-delay: 0.3s; opacity: 0; }
        .stagger-4 { animation-delay: 0.4s; opacity: 0; }
        
        .loading-spinner {
            border: 3px solid rgba(14, 165, 233, 0.1);
            border-radius: 50%;
            border-top: 3px solid #0EA5E9;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .mpesa-logo {
            color: #4CAF50;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Search, TrendingUp, FileText, Download, CheckCircle, AlertCircle, Loader, PhoneCall } = lucide;
        
        // API Configuration
        const API_URL = 'https://leadforge-api.railway.app'; // Will be replaced with actual Railway URL
        
        function App() {
            const [view, setView] = useState('home');
            const [loading, setLoading] = useState(false);
            const [user, setUser] = useState(null);
            
            // Lead Generation State
            const [leadSearch, setLeadSearch] = useState({ location: '', industry: '' });
            const [leads, setLeads] = useState([]);
            
            // SEO Audit State
            const [auditUrl, setAuditUrl] = useState('');
            const [auditResults, setAuditResults] = useState(null);
            
            // Payment State
            const [showPayment, setShowPayment] = useState(false);
            const [paymentType, setPaymentType] = useState('');
            const [phoneNumber, setPhoneNumber] = useState('');
            const [paymentStatus, setPaymentStatus] = useState('');
            
            const searchLeads = async () => {
                if (!leadSearch.location || !leadSearch.industry) {
                    alert('Please enter both location and industry');
                    return;
                }
                
                setLoading(true);
                try {
                    const response = await fetch(`${API_URL}/api/leads/search`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(leadSearch)
                    });
                    
                    if (!response.ok) throw new Error('Search failed');
                    
                    const data = await response.json();
                    setLeads(data.leads);
                } catch (error) {
                    console.error('Lead search error:', error);
                    alert('Failed to search leads. Please try again.');
                } finally {
                    setLoading(false);
                }
            };
            
            const runSEOAudit = async () => {
                if (!auditUrl) {
                    alert('Please enter a website URL');
                    return;
                }
                
                setLoading(true);
                try {
                    const response = await fetch(`${API_URL}/api/seo/audit`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ url: auditUrl })
                    });
                    
                    if (!response.ok) throw new Error('Audit failed');
                    
                    const data = await response.json();
                    setAuditResults(data);
                } catch (error) {
                    console.error('SEO audit error:', error);
                    alert('Failed to run SEO audit. Please try again.');
                } finally {
                    setLoading(false);
                }
            };
            
            const initiatePayment = async (type) => {
                setPaymentType(type);
                setShowPayment(true);
            };
            
            const processPayment = async () => {
                if (!phoneNumber || phoneNumber.length < 10) {
                    alert('Please enter a valid phone number');
                    return;
                }
                
                setPaymentStatus('processing');
                
                try {
                    const amount = paymentType === 'lead' ? 7500 : 3500;
                    
                    const response = await fetch(`${API_URL}/api/payment/mpesa`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            phoneNumber: phoneNumber,
                            amount: amount,
                            serviceType: paymentType
                        })
                    });
                    
                    if (!response.ok) throw new Error('Payment initiation failed');
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        setPaymentStatus('success');
                        setTimeout(() => {
                            setShowPayment(false);
                            setPaymentStatus('');
                            setPhoneNumber('');
                            
                            if (paymentType === 'lead') {
                                exportLeadsToCSV();
                            } else {
                                generatePDFReport();
                            }
                        }, 2000);
                    } else {
                        throw new Error(data.message || 'Payment failed');
                    }
                } catch (error) {
                    console.error('Payment error:', error);
                    setPaymentStatus('error');
                    setTimeout(() => {
                        setPaymentStatus('');
                    }, 3000);
                }
            };
            
            const exportLeadsToCSV = () => {
                const csv = [
                    ['Company', 'Contact', 'Email', 'Phone', 'Location', 'Industry'],
                    ...leads.map(lead => [
                        lead.company,
                        lead.contact,
                        lead.email,
                        lead.phone,
                        lead.location,
                        lead.industry
                    ])
                ].map(row => row.join(',')).join('\n');
                
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `leads_${Date.now()}.csv`;
                a.click();
            };
            
            const generatePDFReport = () => {
                if (!window.jspdf) return;
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                doc.setFontSize(20);
                doc.text('SEO Audit Report', 20, 20);
                
                doc.setFontSize(12);
                doc.text(`Website: ${auditResults.url}`, 20, 35);
                doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 42);
                
                doc.setFontSize(14);
                doc.text('Overall Score', 20, 55);
                doc.setFontSize(24);
                doc.text(`${auditResults.score}/100`, 20, 65);
                
                let y = 80;
                doc.setFontSize(14);
                doc.text('Metrics:', 20, y);
                
                y += 10;
                doc.setFontSize(10);
                Object.entries(auditResults.metrics).forEach(([key, value]) => {
                    doc.text(`${key}: ${value}`, 20, y);
                    y += 7;
                });
                
                doc.save(`seo_audit_${Date.now()}.pdf`);
            };
            
            return (
                <div className="min-h-screen">
                    {/* Header */}
                    <header className="border-b border-gray-700 bg-gray-900/50 backdrop-blur-sm sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center space-x-2">
                                    <TrendingUp className="w-8 h-8 text-sky-400" />
                                    <span className="display-font text-2xl gradient-text">LeadForge AI</span>
                                </div>
                                <nav className="hidden md:flex space-x-6">
                                    <button onClick={() => setView('home')} className="text-gray-300 hover:text-sky-400 transition">Home</button>
                                    <button onClick={() => setView('leads')} className="text-gray-300 hover:text-sky-400 transition">Lead Gen</button>
                                    <button onClick={() => setView('seo')} className="text-gray-300 hover:text-sky-400 transition">SEO Audit</button>
                                </nav>
                            </div>
                        </div>
                    </header>
                    
                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                        {view === 'home' && <HomePage setView={setView} />}
                        {view === 'leads' && (
                            <LeadGenPage 
                                leadSearch={leadSearch}
                                setLeadSearch={setLeadSearch}
                                leads={leads}
                                loading={loading}
                                searchLeads={searchLeads}
                                initiatePayment={initiatePayment}
                            />
                        )}
                        {view === 'seo' && (
                            <SEOPage
                                auditUrl={auditUrl}
                                setAuditUrl={setAuditUrl}
                                auditResults={auditResults}
                                loading={loading}
                                runSEOAudit={runSEOAudit}
                                initiatePayment={initiatePayment}
                            />
                        )}
                    </main>
                    
                    {/* Payment Modal */}
                    {showPayment && (
                        <PaymentModal
                            paymentType={paymentType}
                            phoneNumber={phoneNumber}
                            setPhoneNumber={setPhoneNumber}
                            paymentStatus={paymentStatus}
                            processPayment={processPayment}
                            onClose={() => {
                                setShowPayment(false);
                                setPaymentStatus('');
                                setPhoneNumber('');
                            }}
                        />
                    )}
                </div>
            );
        }
        
        function HomePage({ setView }) {
            return (
                <div className="space-y-16">
                    {/* Hero */}
                    <section className="text-center py-20 animate-slide-up">
                        <h1 className="display-font text-6xl md:text-8xl gradient-text mb-6">
                            LEADFORGE AI
                        </h1>
                        <p className="text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto">
                            Enterprise-grade lead generation and SEO auditing powered by AI. 
                            Turn data into revenue in minutes.
                        </p>
                        <div className="flex flex-col sm:flex-row gap-4 justify-center">
                            <button 
                                onClick={() => setView('leads')}
                                className="btn-primary text-white font-semibold py-4 px-8 rounded-lg"
                            >
                                Generate Leads
                            </button>
                            <button 
                                onClick={() => setView('seo')}
                                className="btn-gold text-white font-semibold py-4 px-8 rounded-lg"
                            >
                                Run SEO Audit
                            </button>
                        </div>
                    </section>
                    
                    {/* Features */}
                    <section className="grid md:grid-cols-3 gap-8">
                        <FeatureCard
                            icon={<Search className="w-12 h-12 text-sky-400" />}
                            title="AI Lead Discovery"
                            description="Search by location and industry. Get enriched contact data instantly."
                            delay="stagger-1"
                        />
                        <FeatureCard
                            icon={<TrendingUp className="w-12 h-12 text-amber-400" />}
                            title="SEO Intelligence"
                            description="Comprehensive website audits with actionable insights and scoring."
                            delay="stagger-2"
                        />
                        <FeatureCard
                            icon={<FileText className="w-12 h-12 text-emerald-400" />}
                            title="Export & Reports"
                            description="Download leads as CSV or SEO reports as PDF. Ready to use."
                            delay="stagger-3"
                        />
                    </section>
                    
                    {/* Pricing */}
                    <section className="bg-gray-800/50 rounded-2xl p-8 md:p-12 card-glow animate-slide-up stagger-4">
                        <h2 className="display-font text-4xl gradient-text text-center mb-8">
                            SIMPLE PRICING
                        </h2>
                        <div className="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                            <PricingCard
                                title="Lead Package"
                                price="KES 7,500"
                                features={[
                                    '10 verified leads',
                                    'Contact information',
                                    'Email addresses',
                                    'Phone numbers',
                                    'CSV export'
                                ]}
                            />
                            <PricingCard
                                title="SEO Audit"
                                price="KES 3,500"
                                features={[
                                    'Complete site analysis',
                                    'Performance scoring',
                                    'Actionable insights',
                                    'PDF report',
                                    'Recommendations'
                                ]}
                            />
                        </div>
                    </section>
                </div>
            );
        }
        
        function FeatureCard({ icon, title, description, delay }) {
            return (
                <div className={`bg-gray-800/50 rounded-xl p-6 card-glow animate-slide-up ${delay}`}>
                    <div className="mb-4">{icon}</div>
                    <h3 className="text-xl font-bold mb-2 text-sky-400">{title}</h3>
                    <p className="text-gray-300">{description}</p>
                </div>
            );
        }
        
        function PricingCard({ title, price, features }) {
            return (
                <div className="bg-gray-900/70 rounded-xl p-8 border border-sky-500/30">
                    <h3 className="display-font text-2xl text-sky-400 mb-2">{title}</h3>
